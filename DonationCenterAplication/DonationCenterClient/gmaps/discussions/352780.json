[
  {
    "Id": "825762",
    "ThreadId": "352780",
    "Html": "\r\n<p><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>'Yandex Traffic. For Russian users of this wonderful component. </pre>\r\n<pre><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span>'Thanks to</span> <span>radioman</span> <span>and all the</span> <span>other</span> <span>selfless</span> <span>helpers</span><span>!</span></span></span></span></pre>\r\n<pre><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><div style=\"color:black; background-color:white\"><pre> <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> DrawProbki()\r\n        MarkerProbkiOvl.Markers.Clear()\r\n        <span style=\"color:blue\">Try</span>\r\n            <span style=\"color:blue\">If</span> ToolStripButton11.Checked <span style=\"color:blue\">Then  ' if check for show traffic</span>\r\n                <span style=\"color:blue\">Dim</span> ret <span style=\"color:blue\">As</span> PureImage = <span style=\"color:blue\">Nothing</span>\r\n                <span style=\"color:blue\">Dim</span> MyTiles <span style=\"color:blue\">As</span> List(Of GMap.NET.GPoint) = GMap.NET.MapProviders.GMapProviders.YandexMap.Projection.GetAreaTileList(MainMap.ViewArea, <span style=\"color:blue\">CInt</span>(MainMap.Zoom), 0) <span style=\"color:green\">'MainMap.MapProvider.Projection.GetAreaTileList(MainMap.ViewArea, CInt(MainMap.Zoom), 0) 'MainMap.Projection.GetAreaTileList(area, i, 0)</span>\r\n\r\n                <span style=\"color:blue\">Dim</span> tm <span style=\"color:blue\">As</span> <span style=\"color:blue\">String</span> = DateTimeToUnixTimestamp(Now.AddHours(-4)).ToString\r\n                <span style=\"color:blue\">For</span> i <span style=\"color:blue\">As</span> <span style=\"color:blue\">Integer</span> = 0 <span style=\"color:blue\">To</span> MyTiles.<span style=\"color:blue\">Count</span> - 1\r\n                    <span style=\"color:blue\">Dim</span> MyPoint <span style=\"color:blue\">As</span> GPoint = GMap.NET.MapProviders.GMapProviders.YandexMap.Projection.FromTileXYToPixel(MyTiles(i)) <span style=\"color:green\">'MainMap.MapProvider.Projection.FromTileXYToPixel(MyTiles(i))</span>\r\n                    <span style=\"color:blue\">Try</span>\r\n                        ret = MainMap.MapProvider.GetTileImageUsingHttp(<span style=\"color:#a31515\">&quot;http://jgo.maps.yandex.net/tiles?l=trf&amp;x=&quot;</span> &#43; (MyTiles(i).X).ToString &#43; <span style=\"color:#a31515\">&quot;&amp;y=&quot;</span> &#43; (MyTiles(i).Y).ToString &#43; <span style=\"color:#a31515\">&quot;&amp;z=&quot;</span> &#43; <span style=\"color:blue\">CInt</span>(MainMap.Zoom).ToString &#43; <span style=\"color:#a31515\">&quot;&amp;tm=&quot;</span> &#43; tm)\r\n                        <span style=\"color:blue\">Dim</span> MyImage <span style=\"color:blue\">As</span> Image = Image.FromStream(ret.Data)\r\n\r\n                        <span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> MyImage <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span>\r\n                            <span style=\"color:blue\">Dim</span> MarkerProbki <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> MyGMap.NET.WindowsForms.Markers.GMapMarker_YandexProbki(GMap.NET.MapProviders.GMapProviders.YandexMap.Projection.FromPixelToLatLng(MyPoint, <span style=\"color:blue\">CInt</span>(MainMap.Zoom)), MyImage)\r\n                            MarkerProbki.IsHitTestVisible = <span style=\"color:blue\">False</span>\r\n                            MarkerProbkiOvl.Markers.Add(MarkerProbki)\r\n                        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n                    <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n                        Debug.Print(i.ToString &#43; <span style=\"color:#a31515\">&quot; - &quot;</span> &#43; MyTiles.<span style=\"color:blue\">Count</span>.ToString &#43; <span style=\"color:#a31515\">&quot;. ERROR: &quot;</span> &#43; ex.Message)\r\n                    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n\r\n                <span style=\"color:blue\">Next</span>\r\n                ToolStripButton12.Enabled = <span style=\"color:blue\">True</span>\r\n            <span style=\"color:blue\">Else</span>\r\n                ToolStripButton12.Enabled = <span style=\"color:blue\">False</span>\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n        <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n            Debug.Print(<span style=\"color:#a31515\">&quot;Yandex trafic ERROR: &quot;</span> &#43; ex.Message)\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Function</span> DateTimeToUnixTimestamp(<span style=\"color:blue\">ByVal</span> _DateTime <span style=\"color:blue\">As</span> DateTime) <span style=\"color:blue\">As</span> <span style=\"color:blue\">Long</span>\r\n        <span style=\"color:blue\">Dim</span> _UnixTimeSpan <span style=\"color:blue\">As</span> TimeSpan = (_DateTime.Subtract(<span style=\"color:blue\">New</span> DateTime(1970, 1, 1, 0, 0, 0)))\r\n        <span style=\"color:blue\">Return</span> <span style=\"color:blue\">CLng</span>(Fix(_UnixTimeSpan.TotalSeconds))\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span>\r\n</pre>\r\n</div>\r\n</span></span></span></pre>\r\n<pre><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"></span></span></span></span></span></pre>\r\n<pre>'===============Custom Marker for show traffic =======================================</pre>\r\n<pre><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><div style=\"color:black; background-color:white\"><pre><span style=\"color:blue\">Imports</span> GMap.NET.WindowsForms\r\n<span style=\"color:blue\">Imports</span> GMap.NET\r\n\r\n<span style=\"color:blue\">Namespace</span> MyGMap.NET.WindowsForms.Markers\r\n    <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Class</span> GMapMarker_YandexProbki\r\n        <span style=\"color:blue\">Inherits</span> GMapMarker\r\n\r\n        <span style=\"color:blue\">Private</span> _image <span style=\"color:blue\">As</span> System.Drawing.Image\r\n        <span style=\"color:blue\">Private</span> _point <span style=\"color:blue\">As</span> PointLatLng\r\n\r\n        <span style=\"color:blue\">Sub</span> <span style=\"color:blue\">New</span>(<span style=\"color:blue\">ByVal</span> iPoint <span style=\"color:blue\">As</span> PointLatLng, image <span style=\"color:blue\">As</span> System.Drawing.Image)\r\n            <span style=\"color:blue\">MyBase</span>.<span style=\"color:blue\">New</span>(iPoint)\r\n            _point = iPoint\r\n            _image = image\r\n            ChangeImage()\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n        <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Overloads</span> <span style=\"color:blue\">Overrides</span> <span style=\"color:blue\">Sub</span> OnRender(<span style=\"color:blue\">ByVal</span> g <span style=\"color:blue\">As</span> Graphics)\r\n            <span style=\"color:blue\">Try</span>\r\n                <span style=\"color:blue\">MyBase</span>.OnRender(g)\r\n                g.DrawImageUnscaled(_image, System.Convert.ToInt32(LocalPosition.X), System.Convert.ToInt32(LocalPosition.Y))\r\n            <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n        <span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> ChangeImage()\r\n            <span style=\"color:blue\">Try</span>\r\n                <span style=\"color:blue\">MyBase</span>.Size = <span style=\"color:blue\">New</span> Drawing.Size(_image.Size.Width, _image.Size.Height)\r\n            <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n            <span style=\"color:green\">'MyBase.Offset = New Drawing.Point((_image.Size.Width), _image.Size.Height)</span>\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Class</span>\r\n\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Namespace</span>\r\n</pre>\r\n</div>\r\n</span></span></span></pre>\r\n<pre><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"><span style=\"font-family:Consolas; color:#0000ff; font-size:x-small\"></span></span></pre>\r\n</div>\r\n</span></span></span>\r\n<p></p>\r\n",
    "PostedDate": "2012-04-18T22:21:47.65-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "825890",
    "ThreadId": "352780",
    "Html": "<p>..actualy you need to create custom provider with traffic layer, i'll add it, thanks for info</p>",
    "PostedDate": "2012-04-19T05:01:45.51-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "825899",
    "ThreadId": "352780",
    "Html": "<p><span class=\"hps\">Let me</span> <span class=\"hps\">learn to</span> <span class=\"hps\">work with</span> <span class=\"hps\">Yandex</span> <span class=\"hps\">routes.</span> <span class=\"hps\">This</span> <span class=\"hps\">will need to add</span> <span class=\"hps\">exactly.</span></p>\r\n<p><span class=\"hps\">P.S. Radioman, а по русски ты понимаешь?</span></p>",
    "PostedDate": "2012-04-19T05:18:25.71-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "825905",
    "ThreadId": "352780",
    "Html": "<p>my english is much better ;}</p>",
    "PostedDate": "2012-04-19T05:25:08.87-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "825906",
    "ThreadId": "352780",
    "Html": "<blockquote style=\"padding-bottom: 0px; font-style: italic; margin: 0.25em 1em 0px; padding-left: 0.25em; padding-right: 0.25em; padding-top: 0px; border: #ccc 0.1em solid;\"><strong>radioman wrote:</strong><br />\r\n<p>..actualy you need to create custom provider with traffic layer, i'll add it, thanks for info</p>\r\n</blockquote>\r\n<p><span class=\"hps\">All right.</span> <span class=\"hps\">Google</span> <span class=\"hps\">will help us <span class=\"hps\">communicate</span>. ;)</span><br />custom provider -&nbsp;<span class=\"hps\">will</span> <span class=\"hps\">be stored in</span> <span class=\"hps\">the cache.</span> <span class=\"hps\">Do not</span> <span class=\"hps\">see the point</span><span>, these</span> <span class=\"hps\">changes</span> <span class=\"hps\">in traffic jams</span> <span class=\"hps\">- you need</span> <span class=\"hps\">to update</span><span>.</span> <span class=\"hps\">I have</span> <span class=\"hps\">this</span> <span class=\"hps\">working or</span> <span class=\"hps\">button or</span> <span class=\"hps\">automatic</span> <span class=\"hps\">timed out</span><span>.</span> <span class=\"hps\">This is the first</span><span>.</span> <span class=\"hps\">And the second</span><span>.</span> <span class=\"hps\">Now I</span> <span class=\"hps\">place the transparent</span> <span class=\"hps\">layer</span> <span class=\"hps\">plugs</span> <span class=\"hps\">into any</span> <span class=\"hps\">type of map</span> <span class=\"hps\">or satellite.</span></p>",
    "PostedDate": "2012-04-19T05:29:31.007-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "825910",
    "ThreadId": "352780",
    "Html": "<p>hm, thats true</p>",
    "PostedDate": "2012-04-19T05:33:53.347-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "825927",
    "ThreadId": "352780",
    "Html": "<p><span class=\"hps\">Now, if</span> <span class=\"hps\">gmap</span> <span class=\"hps\">would</span> <span class=\"hps\">such a thing as</span> <span class=\"hps atn\">a sub-</span><span>provider for</span> <span class=\"hps\">traffic jams</span><span>, road</span> <span class=\"hps\">events and other</span> <span class=\"hps\">services from</span> <span class=\"hps\">Google,</span> <span class=\"hps\">Yandex</span><span>, and others,</span> <span class=\"hps\">which will be</span> <span class=\"hps\">superimposed on the</span> <span class=\"hps\">tile</span> <span class=\"hps\">selected</span> <span class=\"hps\">primary</span> <span class=\"hps\">provider</span><span>, it would be</span> <span class=\"hps\">very cool.</span> <span class=\"hps\">Can anyone</span> <span class=\"hps\">else</span> <span class=\"hps\">tell</span> <span class=\"hps\">us</span> <span class=\"hps\">how to</span> <span class=\"hps\">obtain such</span> <span class=\"hps\">additional information</span> <span class=\"hps\">and</span> <span class=\"hps\">then you</span><span>'ll</span> <span class=\"hps\">do this sort of</span> <span class=\"hps\">sub</span><span>-provider.</span></p>\r\n<p><span><span class=\"hps\">&nbsp;Thanks. Best regards,</span> <span class=\"hps\">Igor</span></span></p>",
    "PostedDate": "2012-04-19T06:14:04.067-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]