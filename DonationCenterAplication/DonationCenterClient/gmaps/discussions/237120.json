[
  {
    "Id": "531066",
    "ThreadId": "237120",
    "Html": "\r\n<p>Hi!</p>\r\n<p>First of all thanks a lot for this great control!</p>\r\n<p>Now my issue: the OnMarkerEnter event is fired whenever the mouse <strong>moves</strong> over the marker&nbsp; and not only once when the mouse\r\n<strong>enters</strong> the marker. So when you are doing some time-consuming work when this event is fired, the performance is suffering.</p>\r\n<p>What I did, was to simply set a boolean field to check if the event was already fired, and only fire it if the field is false:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>...\r\n<span style=\"color:blue\">internal</span> <span style=\"color:blue\">bool</span> onMarkerEnterCalled = <span style=\"color:blue\">false</span>;\r\n<span style=\"color:blue\">internal</span> <span style=\"color:blue\">bool</span> onMarkerLeaveCalled = <span style=\"color:blue\">false</span>;\r\n...\r\n<span style=\"color:blue\">foreach</span>(GMapMarker m <span style=\"color:blue\">in</span> o.Markers)\r\n                     {\r\n                        <span style=\"color:blue\">if</span>(m.IsVisible &amp;&amp; m.IsHitTestVisible)\r\n                        {\r\n                           <span style=\"color:blue\">if</span>(m.LocalArea.Contains(e.X, e.Y))\r\n                           {\r\n                              <span style=\"color:blue\">this</span>.Cursor = System.Windows.Forms.Cursors.Hand;\r\n                              m.IsMouseOver = <span style=\"color:blue\">true</span>;\r\n                              Invalidate(<span style=\"color:blue\">false</span>);\r\n                              onMarkerLeaveCalled = <span style=\"color:blue\">false</span>;\r\n                              <span style=\"color:blue\">if</span> (OnMarkerEnter != <span style=\"color:blue\">null</span> &amp;&amp; !onMarkerEnterCalled)\r\n                              {\r\n                                  OnMarkerEnter(m);\r\n                                  onMarkerEnterCalled = <span style=\"color:blue\">true</span>;\r\n                              }\r\n                           }\r\n                           <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span>(m.IsMouseOver)\r\n                           {\r\n                              <span style=\"color:blue\">this</span>.Cursor = System.Windows.Forms.Cursors.Default;\r\n                              m.IsMouseOver = <span style=\"color:blue\">false</span>;\r\n                              Invalidate(<span style=\"color:blue\">false</span>);\r\n                              onMarkerEnterCalled = <span style=\"color:blue\">false</span>;\r\n                              <span style=\"color:blue\">if</span> (OnMarkerLeave != <span style=\"color:blue\">null</span> &amp;&amp; !onMarkerLeaveCalled)\r\n                              {\r\n                                  OnMarkerLeave(m);\r\n                                  onMarkerLeaveCalled = <span style=\"color:blue\">true</span>;\r\n                              }\r\n                           }\r\n                        }\r\n                     }\r\n...\r\n</pre>\r\n</div>\r\nNow my question: How can I get the same functionality without changing the source-code everytime a new version of GMap is released?\r\n<p></p>\r\n<p>I tried to override OnMouseMove() in a derived class but could not get it to work.</p>\r\n<p>Can you please help?</p>\r\n",
    "PostedDate": "2010-12-04T02:52:02.753-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "531122",
    "ThreadId": "237120",
    "Html": "\r\n<p>thanks, fixed</p>\r\n",
    "PostedDate": "2010-12-04T07:02:10.973-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "812607",
    "ThreadId": "237120",
    "Html": "<p>I experienced this same behavoir of the OnMarkerEnter. Was suprised&nbsp; to see in this thread that it should have been fixed. Now I look into the latest sources and I don't see the fixes proposed by Xandolph. I tried fixing this in my local project and the result is exactly what i'am looking for. I would reccomend re-applying this fix into this (great!) project.</p>",
    "PostedDate": "2012-03-19T11:10:59.623-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "812635",
    "ThreadId": "237120",
    "Html": "<p>this issue do not exist</p>",
    "PostedDate": "2012-03-19T11:53:18.503-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "812735",
    "ThreadId": "237120",
    "Html": "<p>I will investigate a bit more this week and will post what I find.</p>\r\n<p>It just smoothened things up when I was implementing the System.Drawing.HTMLTooltip extension (see codeproject, great tooltip extension by the way) using both OnMarkerEnter and OnMarkerLeave trigger. Sometimes tooltips appeared on weird places, sometimes they didn't dissapear. Everything seemed to be solved when I applied this fix. Although I must admit existing code looks solid.</p>",
    "PostedDate": "2012-03-19T15:36:38.703-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "814370",
    "ThreadId": "237120",
    "Html": "<p>Ok I know what happened its my fault tooltip was running on timer and they don't dispose well so tooltip popped up at almost random places and times.</p>\r\n<p>However I noticed somthing else when markers are overlapping and you move the mouse over the area where markers overlap everything is fine. However when you move out of the overlapping area, but are still over 1 of the 2 markers the mousecursor will change back to normal. The function OnMouseMove in class GMapControl.cs should be edited as following to correct the problem.</p>\r\n<p>My edits are between</p>\r\n<p>///// &gt;&gt; JP1980 begin</p>\r\n<p>///// &gt;&gt; JP1980 end</p>\r\n<p>&nbsp;</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>      <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 begin</span>\r\n      <span style=\"color: green;\">//Cursor cursorBefore = Cursors.Default;</span>\r\n      Cursor cursorBefore = <span style=\"color: blue;\">null</span>;\r\n      <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 end</span>\r\n<span style=\"color: blue;\">#endif</span>\r\n\r\n      <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;summary&gt;</span>\r\n      <span style=\"color: gray;\">///</span><span style=\"color: green;\"> Gets the width and height of a rectangle centered on the point the mouse</span>\r\n      <span style=\"color: gray;\">///</span><span style=\"color: green;\"> button was pressed, within which a drag operation will not begin.</span>\r\n      <span style=\"color: gray;\">///</span> <span style=\"color: gray;\">&lt;/summary&gt;</span>\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n      <span style=\"color: blue;\">public</span> Size DragSize = SystemInformation.DragSize;\r\n<span style=\"color: blue;\">#else</span>\r\n      <span style=\"color: blue;\">public</span> Size DragSize = <span style=\"color: blue;\">new</span> Size(4, 4);\r\n<span style=\"color: blue;\">#endif</span>\r\n\r\n      <span style=\"color: blue;\">protected</span> <span style=\"color: blue;\">override</span> <span style=\"color: blue;\">void</span> OnMouseMove(MouseEventArgs e)\r\n      {\r\n         <span style=\"color: blue;\">if</span>(!Core.IsDragging &amp;&amp; !Core.mouseDown.IsEmpty)\r\n         {\r\n<span style=\"color: blue;\">#if</span> PocketPC\r\n            GPoint p = <span style=\"color: blue;\">new</span> GPoint(e.X, e.Y);\r\n<span style=\"color: blue;\">#else</span>\r\n            GPoint p = ApplyRotationInversion(e.X, e.Y);\r\n<span style=\"color: blue;\">#endif</span>\r\n            <span style=\"color: blue;\">if</span>(Math.Abs(p.X - Core.mouseDown.X) * 2 &gt;= DragSize.Width || Math.Abs(p.Y - Core.mouseDown.Y) * 2 &gt;= DragSize.Height)\r\n            {\r\n               Core.BeginDrag(Core.mouseDown);\r\n            }\r\n         }\r\n\r\n         <span style=\"color: blue;\">if</span>(Core.IsDragging)\r\n         {\r\n            <span style=\"color: blue;\">if</span>(!isDragging)\r\n            {\r\n               isDragging = <span style=\"color: blue;\">true</span>;\r\n               Debug.WriteLine(<span style=\"color: #a31515;\">\"IsDragging = \"</span> + isDragging);\r\n\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n               cursorBefore = <span style=\"color: blue;\">this</span>.Cursor;\r\n               <span style=\"color: blue;\">this</span>.Cursor = Cursors.SizeAll;\r\n<span style=\"color: blue;\">#endif</span>\r\n            }\r\n\r\n            <span style=\"color: blue;\">if</span>(BoundsOfMap.HasValue &amp;&amp; !BoundsOfMap.Value.Contains(Position))\r\n            {\r\n               <span style=\"color: green;\">// ...</span>\r\n            }\r\n            <span style=\"color: blue;\">else</span>\r\n            {\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n               Core.mouseCurrent = ApplyRotationInversion(e.X, e.Y);\r\n<span style=\"color: blue;\">#else</span>\r\n               Core.mouseCurrent = <span style=\"color: blue;\">new</span> GPoint(e.X, e.Y);\r\n<span style=\"color: blue;\">#endif</span>\r\n               Core.Drag(Core.mouseCurrent);\r\n\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n               <span style=\"color: blue;\">if</span>(MobileMode)\r\n               {\r\n                  ForceUpdateOverlays();\r\n               }\r\n<span style=\"color: blue;\">#else</span>\r\n               ForceUpdateOverlays();\r\n<span style=\"color: blue;\">#endif</span>\r\n\r\n               <span style=\"color: blue;\">base</span>.Invalidate();\r\n            }\r\n         }\r\n         <span style=\"color: blue;\">else</span>\r\n         {\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n            <span style=\"color: blue;\">if</span>(isSelected &amp;&amp; !selectionStart.IsZero &amp;&amp; (Form.ModifierKeys == Keys.Alt || Form.ModifierKeys == Keys.Shift))\r\n            {\r\n               selectionEnd = FromLocalToLatLng(e.X, e.Y);\r\n               {\r\n                  GMap.NET.PointLatLng p1 = selectionStart;\r\n                  GMap.NET.PointLatLng p2 = selectionEnd;\r\n\r\n                  <span style=\"color: blue;\">double</span> x1 = Math.Min(p1.Lng, p2.Lng);\r\n                  <span style=\"color: blue;\">double</span> y1 = Math.Max(p1.Lat, p2.Lat);\r\n                  <span style=\"color: blue;\">double</span> x2 = Math.Max(p1.Lng, p2.Lng);\r\n                  <span style=\"color: blue;\">double</span> y2 = Math.Min(p1.Lat, p2.Lat);\r\n\r\n                  SelectedArea = <span style=\"color: blue;\">new</span> RectLatLng(y1, x1, x2 - x1, y1 - y2);\r\n               }\r\n            }\r\n            <span style=\"color: blue;\">else</span>\r\n<span style=\"color: blue;\">#endif</span>\r\n               <span style=\"color: blue;\">if</span>(Core.mouseDown.IsEmpty)\r\n               {\r\n                  <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 begin</span>\r\n                  <span style=\"color: blue;\">bool</span> IsOnMarker = <span style=\"color: blue;\">false</span>;\r\n                  <span style=\"color: blue;\">bool</span> LeftMarker = <span style=\"color: blue;\">false</span>;\r\n                  <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 end</span>\r\n                   \r\n                  <span style=\"color: blue;\">for</span> (<span style=\"color: blue;\">int</span> i = Overlays.Count - 1; i &gt;= 0; i--)\r\n                  {\r\n                     GMapOverlay o = Overlays[i];\r\n                     <span style=\"color: blue;\">if</span>(o != <span style=\"color: blue;\">null</span> &amp;&amp; o.IsVisibile)\r\n                     {\r\n                        <span style=\"color: blue;\">foreach</span> (GMapMarker m <span style=\"color: blue;\">in</span> o.Markers)\r\n                        {\r\n                           <span style=\"color: blue;\">if</span>(m.IsVisible &amp;&amp; m.IsHitTestVisible)\r\n                           {\r\n                              <span style=\"color: blue;\">#region</span> -- check --\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                              <span style=\"color: blue;\">if</span>((MobileMode &amp;&amp; m.LocalArea.Contains(e.X, e.Y)) || (!MobileMode &amp;&amp; m.LocalAreaInControlSpace.Contains(e.X, e.Y)))\r\n<span style=\"color: blue;\">#else</span>\r\n                              <span style=\"color: blue;\">if</span> (m.LocalArea.Contains(e.X, e.Y))\r\n<span style=\"color: blue;\">#endif</span>\r\n                              {\r\n                                 <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 begin</span>\r\n                                 IsOnMarker = <span style=\"color: blue;\">true</span>;\r\n                                 <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 end</span>\r\n                                  \r\n                                 <span style=\"color: blue;\">if</span> (!m.IsMouseOver)\r\n                                 {\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                                    <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 begin</span>\r\n                                    <span style=\"color: blue;\">if</span> (cursorBefore == <span style=\"color: blue;\">null</span>)\r\n                                    <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 end</span>\r\n                                        cursorBefore = <span style=\"color: blue;\">this</span>.Cursor;\r\n                                    <span style=\"color: blue;\">this</span>.Cursor = Cursors.Hand;\r\n<span style=\"color: blue;\">#endif</span>\r\n                                     \r\n                                    m.IsMouseOver = <span style=\"color: blue;\">true</span>;\r\n\r\n                                    <span style=\"color: blue;\">if</span>(OnMarkerEnter != <span style=\"color: blue;\">null</span>)\r\n                                    {\r\n                                      OnMarkerEnter(m);\r\n                                      Debug.Print(<span style=\"color: #a31515;\">\"Enter\"</span>);\r\n                                    }\r\n\r\n                                    Invalidate();\r\n                                 }\r\n                              }\r\n                              <span style=\"color: blue;\">else</span> <span style=\"color: blue;\">if</span>(m.IsMouseOver)\r\n                              {\r\n                                  <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 start</span>\r\n                                  LeftMarker = <span style=\"color: blue;\">true</span>;\r\n<span style=\"color: green;\">//#if !PocketPC</span>\r\n<span style=\"color: green;\">//                                 this.Cursor = this.cursorBefore;</span>\r\n<span style=\"color: green;\">//                                 cursorBefore = null;</span>\r\n<span style=\"color: green;\">//#endif</span>\r\n                                 <span style=\"color: green;\">//#endif</span>\r\n                                 <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 end</span>\r\n                                  \r\n                                 m.IsMouseOver = <span style=\"color: blue;\">false</span>;\r\n\r\n                                 <span style=\"color: blue;\">if</span>(OnMarkerLeave != <span style=\"color: blue;\">null</span>)\r\n                                 {\r\n                                    OnMarkerLeave(m);\r\n                                    Debug.Print(<span style=\"color: #a31515;\">\"Leave\"</span>);\r\n                                 }\r\n                                 \r\n                                  Invalidate();\r\n                              }\r\n                              <span style=\"color: blue;\">#endregion</span>\r\n                           }\r\n                        }\r\n\r\n                        <span style=\"color: blue;\">foreach</span>(GMapRoute m <span style=\"color: blue;\">in</span> o.Routes)\r\n                        {\r\n                           <span style=\"color: blue;\">if</span>(m.IsVisible &amp;&amp; m.IsHitTestVisible)\r\n                           {\r\n                              <span style=\"color: blue;\">#region</span> -- check --\r\n\r\n                              GPoint rp = <span style=\"color: blue;\">new</span> GPoint(e.X, e.Y);\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                              <span style=\"color: blue;\">if</span>(!MobileMode)\r\n                              {\r\n                                 rp.OffsetNegative(Core.renderOffset);\r\n                              }\r\n<span style=\"color: blue;\">#endif</span>\r\n                              <span style=\"color: blue;\">if</span>(m.IsInside((<span style=\"color: blue;\">int</span>)rp.X, (<span style=\"color: blue;\">int</span>)rp.Y))\r\n                              {\r\n                                 <span style=\"color: blue;\">if</span>(!m.IsMouseOver)\r\n                                 {\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                                    cursorBefore = <span style=\"color: blue;\">this</span>.Cursor;\r\n                                    <span style=\"color: blue;\">this</span>.Cursor = Cursors.Hand;\r\n<span style=\"color: blue;\">#endif</span>\r\n                                    m.IsMouseOver = <span style=\"color: blue;\">true</span>;\r\n\r\n                                    <span style=\"color: blue;\">if</span>(OnRouteEnter != <span style=\"color: blue;\">null</span>)\r\n                                    {\r\n                                       OnRouteEnter(m);\r\n                                    }\r\n\r\n                                    Invalidate();\r\n                                 }\r\n                              }\r\n                              <span style=\"color: blue;\">else</span>\r\n                              {\r\n                                 <span style=\"color: blue;\">if</span>(m.IsMouseOver)\r\n                                 {\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                                    <span style=\"color: blue;\">this</span>.Cursor = <span style=\"color: blue;\">this</span>.cursorBefore;\r\n                                    cursorBefore = <span style=\"color: blue;\">null</span>;\r\n<span style=\"color: blue;\">#endif</span>\r\n                                    m.IsMouseOver = <span style=\"color: blue;\">false</span>;\r\n\r\n                                    <span style=\"color: blue;\">if</span>(OnRouteLeave != <span style=\"color: blue;\">null</span>)\r\n                                    {\r\n                                       OnRouteLeave(m);\r\n                                    }\r\n\r\n                                    Invalidate();\r\n                                 }\r\n                              }\r\n                              <span style=\"color: blue;\">#endregion</span>\r\n                           }\r\n                        }\r\n\r\n                        <span style=\"color: blue;\">foreach</span>(GMapPolygon m <span style=\"color: blue;\">in</span> o.Polygons)\r\n                        {\r\n                           <span style=\"color: blue;\">if</span>(m.IsVisible &amp;&amp; m.IsHitTestVisible)\r\n                           {\r\n                              <span style=\"color: blue;\">#region</span> -- check --\r\n                              <span style=\"color: blue;\">if</span>(m.IsInside(FromLocalToLatLng(e.X, e.Y)))\r\n                              {\r\n                                 <span style=\"color: blue;\">if</span>(!m.IsMouseOver)\r\n                                 {\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                                    cursorBefore = <span style=\"color: blue;\">this</span>.Cursor;\r\n                                    <span style=\"color: blue;\">this</span>.Cursor = Cursors.Hand;\r\n<span style=\"color: blue;\">#endif</span>\r\n                                    m.IsMouseOver = <span style=\"color: blue;\">true</span>;\r\n\r\n                                    <span style=\"color: blue;\">if</span>(OnPolygonEnter != <span style=\"color: blue;\">null</span>)\r\n                                    {\r\n                                       OnPolygonEnter(m);\r\n                                    }\r\n\r\n                                    Invalidate();\r\n                                 }\r\n                              }\r\n                              <span style=\"color: blue;\">else</span>\r\n                              {\r\n                                 <span style=\"color: blue;\">if</span>(m.IsMouseOver)\r\n                                 {\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                                    <span style=\"color: blue;\">this</span>.Cursor = <span style=\"color: blue;\">this</span>.cursorBefore;\r\n                                    cursorBefore = <span style=\"color: blue;\">null</span>;\r\n<span style=\"color: blue;\">#endif</span>\r\n                                    m.IsMouseOver = <span style=\"color: blue;\">false</span>;\r\n\r\n                                    <span style=\"color: blue;\">if</span>(OnPolygonLeave != <span style=\"color: blue;\">null</span>)\r\n                                    {\r\n                                       OnPolygonLeave(m);\r\n                                    }\r\n\r\n                                    Invalidate();\r\n                                 }\r\n                              }\r\n                              <span style=\"color: blue;\">#endregion</span>\r\n                           }\r\n                        }\r\n                     }\r\n                  }\r\n\r\n                  <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 begin</span>\r\n<span style=\"color: blue;\">#if</span> !PocketPC\r\n                 <span style=\"color: blue;\">if</span> (LeftMarker &amp;&amp; !IsOnMarker)\r\n                 {\r\n                    <span style=\"color: blue;\">this</span>.Cursor = <span style=\"color: blue;\">this</span>.cursorBefore;\r\n                    <span style=\"color: blue;\">this</span>.cursorBefore = <span style=\"color: blue;\">null</span>;\r\n                 }\r\n<span style=\"color: blue;\">#endif</span>\r\n                   <span style=\"color: gray;\">///</span><span style=\"color: green;\">// &gt;&gt; JP1980 end</span>\r\n               }\r\n         }\r\n         <span style=\"color: blue;\">base</span>.OnMouseMove(e);\r\n      }\r\n\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-03-22T17:59:20.837-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]