[
  {
    "Id": "440238",
    "ThreadId": "211884",
    "Html": "<p>Hi All,</p>\r\n<p>When i run this great project on DOPOD D600, i found it was very slowly by GPRS.</p>\r\n<p>I studied the core.FindTilesAround(ref List&lt;Point&gt; list) , it will load 9 tiles from server for mobile side.</p>\r\n<p>And acturlly we can only load 4 tiles when we load the map, some suggestions from me.</p>\r\n<p>But i got some problems with the map move, which need to optimize the GMapControl.OnMouseMove(MouseEventArgs e).</p>\r\n<p>Could Radioman gives some comment on this? Thanks in advance!</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>      <span style=\"color:blue\">void</span> FindTilesAround(<span style=\"color:blue\">ref</span> List&lt;Point&gt; list)\r\n      {\r\n         list.Clear();\r\n         <span style=\"color:green\">//1.first add the current tile;Sterning</span>\r\n         list.Add(centerTileXYLocation);\r\n\r\n<span style=\"color:blue\">#if</span> PocketPC\r\n         <span style=\"color:green\">//2.get the TopLeft Pixel Point of current Tile.         </span>\r\n         Point centerTileXYPixel = Projection.FromTileXYToPixel(centerTileXYLocation);\r\n         Point centerTileXY = centerTileXYLocation; \r\n\r\n         <span style=\"color:green\">//3.Center Pixex of Control.Compare it with CenterTileXYPixel to get just 4 Tiles for mobile. </span>\r\n         Point centerPixel = <span style=\"color:blue\">new</span> Point(Width / 2 - renderOffset.X, Height / 2 - renderOffset.Y);\r\n         <span style=\"color:blue\">if</span> ((centerPixel.X - centerTileXYPixel.X) &gt; projection.TileSize.Width/2)\r\n          {\r\n            centerTileXY.X +=1;\r\n\r\n          }\r\n\r\n         <span style=\"color:blue\">if</span> ((centerPixel.Y - centerTileXYPixel.Y) &gt; projection.TileSize.Height/2)\r\n          {\r\n              centerTileXY.Y += 1;\r\n\r\n          }\r\n\r\n          <span style=\"color:blue\">if</span> (!list.Contains(centerTileXY))\r\n          {\r\n              list.Add(centerTileXY);\r\n          }\r\n\r\n          Point p = centerTileXY;\r\n          p.Y -= 1;\r\n\r\n          <span style=\"color:blue\">if</span> (!list.Contains(p))\r\n          {\r\n              list.Add(p);\r\n          }\r\n\r\n          p = centerTileXY;\r\n          p.X -= 1;\r\n\r\n          <span style=\"color:blue\">if</span> (!list.Contains(p))\r\n          {\r\n              list.Add(p);\r\n          }\r\n\r\n\r\n          p = centerTileXY;\r\n          p.X -= 1;\r\n          p.Y -= 1;\r\n\r\n          <span style=\"color:blue\">if</span> (!list.Contains(p))\r\n          {\r\n              list.Add(p);\r\n          }\r\n\r\n<span style=\"color:blue\">#else</span>\r\n         <span style=\"color:green\">//start - old method, which will load 16 tiles for PC and 9 tiles for Mobile</span>\r\n          <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> i = -sizeOfMapArea.Width; i &lt;= sizeOfMapArea.Width; i++)\r\n          {\r\n              <span style=\"color:blue\">for</span> (<span style=\"color:blue\">int</span> j = -sizeOfMapArea.Height; j &lt;= sizeOfMapArea.Height; j++)\r\n              {\r\n                  Point p = centerTileXYLocation;\r\n\r\n                  p.X += i;\r\n                  p.Y += j;\r\n\r\n\r\n                  <span style=\"color:blue\">if</span> (p.X &gt;= minOfTiles.Width &amp;&amp; p.Y &gt;= minOfTiles.Height &amp;&amp; p.X &lt;= maxOfTiles.Width &amp;&amp; p.Y &lt;= maxOfTiles.Height)\r\n                  {\r\n                      <span style=\"color:blue\">if</span> (!list.Contains(p))\r\n                      {\r\n                          list.Add(p);\r\n\r\n                      }\r\n                  }\r\n              }\r\n          }\r\n          <span style=\"color:green\">//end - old method, which will load 16 tiles for PC and 9 tiles for Mobile</span>\r\n\r\n<span style=\"color:blue\">#endif</span>\r\n         <span style=\"color:blue\">if</span>(GMaps.Instance.ShuffleTilesOnLoad)\r\n         {\r\n            Stuff.Shuffle&lt;Point&gt;(list);\r\n         }\r\n      }\r\n\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-05-07T00:53:52.243-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "440241",
    "ThreadId": "211884",
    "Html": "<p>well, use cache, gprs is the last option, and on mobile it runs quite fast, check videos</p>",
    "PostedDate": "2010-05-07T01:10:00.333-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]