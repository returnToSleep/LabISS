[
  {
    "Id": "537283",
    "ThreadId": "238747",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I explain my prblem.</p>\r\n<p>&nbsp;</p>\r\n<p>Using the project Demo.clouds, I made some changes in it.&nbsp;&nbsp; I'have removed the Form.</p>\r\n<p>Then I created a custom control like MapaContro.cs to put the same code from the removed Form. So then I can use this project as a librarie in another project.</p>\r\n<p>It compiles perfectly.</p>\r\n<p>Then, when I create a new project to import the library, I can put the new control from the toolbox and shows the map on the form. However, when I execute it, visual studio show me the next error.</p>\r\n<p><strong>Could not load file or assembly 'CloudsDemo, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. An attempt was made to load a program with an incorrect format.</strong></p>\r\n<p>&nbsp;</p>\r\n<p>I have tested the references and all the libraries are included, I think.</p>\r\n<p><strong>Gmap.net.core, gmap.net.windowsforms, system.data.sqlite.</strong></p>\r\n<p>Why it dosen't run as a custom control in a library.</p>\r\n<p>&nbsp;</p>\r\n<p>I'm a little desesperated.</p>\r\n<p>&nbsp;</p>\r\n<p>If you could help me.</p>\r\n<p>&nbsp;</p>\r\n<p>Thank you very much.</p>\r\n<p><strong><br>\r\n</strong></p>\r\n",
    "PostedDate": "2010-12-17T06:25:05.357-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "537307",
    "ThreadId": "238747",
    "Html": "\r\n<p>Sorry, it was my problem. I had put x86 instead of any CPU.</p>\r\n<p>&nbsp;</p>\r\n<p>But now it shows the map. However, without any image with that message:</p>\r\n<p>exception: The type initializer for 'SingletonCreator' threw an exception.</p>\r\n<p>We are sorry, but we don't have imagery at this zoom level for this region.</p>\r\n<p>&nbsp;</p>\r\n<p>This the code of the custom control:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">using</span> System;\r\n<span style=\"color:blue\">using</span> System.Collections.Generic;\r\n<span style=\"color:blue\">using</span> System.ComponentModel;\r\n<span style=\"color:blue\">using</span> System.Drawing;\r\n<span style=\"color:blue\">using</span> System.Data;\r\n\r\n<span style=\"color:blue\">using</span> System.Text;\r\n<span style=\"color:blue\">using</span> System.Windows.Forms;\r\n<span style=\"color:blue\">using</span> GMap.NET;\r\n<span style=\"color:blue\">using</span> GMap.NET.WindowsForms;\r\n<span style=\"color:blue\">using</span> GMap.NET.Properties;\r\n\r\n<span style=\"color:blue\">namespace</span> CloudsDemo\r\n{\r\n\r\n\r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">partial</span> <span style=\"color:blue\">class</span> EatMapetaGoo : UserControl\r\n    {\r\n\r\n        <span style=\"color:green\">// clouds boundaries</span>\r\n        <span style=\"color:blue\">readonly</span> PointLatLng gtl = <span style=\"color:blue\">new</span> PointLatLng(50.4066263673011, -127.620375523875);\r\n        <span style=\"color:blue\">readonly</span> PointLatLng gbr = <span style=\"color:blue\">new</span> PointLatLng(21.652538062803, -66.517937876818);\r\n        <span style=\"color:blue\">readonly</span> PointLatLng pointSector2 = <span style=\"color:blue\">new</span> PointLatLng(37.96335, -7.54113);\r\n        <span style=\"color:blue\">readonly</span> PointLatLng pointSector1 = <span style=\"color:blue\">new</span> PointLatLng(37.972264, -7.505593);\r\n        <span style=\"color:blue\">readonly</span> GMapOverlay mainOverlay;\r\n        <span style=\"color:blue\">readonly</span> GMapImage hidrat;\r\n        <span style=\"color:blue\">readonly</span> GMapImage sector;\r\n\r\n\r\n        <span style=\"color:blue\">public</span> EatMapetaGoo()\r\n        {\r\n\r\n\r\n\r\n            InitializeComponent();\r\n\r\n            \r\n            <span style=\"color:blue\">if</span> (!DesignMode)\r\n            {\r\n              \r\n                <span style=\"color:gray\">///</span><span style=\"color:green\">/try</span>\r\n                <span style=\"color:gray\">///</span><span style=\"color:green\">/{</span>\r\n                <span style=\"color:gray\">///</span><span style=\"color:green\">/   System.Net.IPHostEntry e = System.Net.Dns.GetHostEntry(&quot;www.google.com&quot;);</span>\r\n                <span style=\"color:gray\">///</span><span style=\"color:green\">/}</span>\r\n                <span style=\"color:gray\">///</span><span style=\"color:green\">/catch</span>\r\n                <span style=\"color:gray\">///</span><span style=\"color:green\">/{</span>\r\n                <span style=\"color:gray\">///</span><span style=\"color:green\">/ }</span>\r\n\r\n                <span style=\"color:green\">//bool ok = GMaps.Instance.ImportFromGMDB(@&quot;C:\\Users\\eldruida\\Desktop\\nivellsSectors.gmdb&quot;);</span>\r\n                <span style=\"color:green\">//if (ok)</span>\r\n                <span style=\"color:green\">//{</span>\r\n                <span style=\"color:green\">//    MessageBox.Show(&quot;Complete!&quot;, &quot;GMap.NET&quot;, MessageBoxButtons.OK, MessageBoxIcon.Information);</span>\r\n                <span style=\"color:green\">//}</span>\r\n                <span style=\"color:green\">//else</span>\r\n                <span style=\"color:green\">//{</span>\r\n                <span style=\"color:green\">//    MessageBox.Show(&quot;Failed!&quot;, &quot;GMap.NET&quot;, MessageBoxButtons.OK, MessageBoxIcon.Warning);</span>\r\n                <span style=\"color:green\">//}</span>\r\n\r\n                <span style=\"color:blue\">try</span>\r\n                {\r\n                    System.Net.IPHostEntry e = System.Net.Dns.GetHostEntry(<span style=\"color:#a31515\">&quot;www.google.com&quot;</span>);\r\n                }\r\n                <span style=\"color:blue\">catch</span>\r\n                {\r\n                    <span style=\"color:green\">//MapControl.Manager.Mode = AccessMode.CacheOnly;</span>\r\n                    MessageBox.Show(<span style=\"color:#a31515\">&quot;No internet connection avaible, going to CacheOnly mode.&quot;</span>, <span style=\"color:#a31515\">&quot;GMap.NET - CloudsDemo&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Warning);\r\n                }\r\n\r\n                mapControl1.OnMapZoomChanged &#43;= <span style=\"color:blue\">new</span> MapZoomChanged(mapControl_OnMapZoomChanged);\r\n\r\n                mainOverlay = <span style=\"color:blue\">new</span> GMapOverlay(mapControl1, <span style=\"color:#a31515\">&quot;top&quot;</span>);\r\n                mapControl1.Overlays.Add(mainOverlay);\r\n\r\n                hidrat = <span style=\"color:blue\">new</span> GMapImage(gtl);\r\n                hidrat.Image = Properties.Resources.bigMarkerGreen;\r\n                sector = <span style=\"color:blue\">new</span> GMapImage(pointSector1);\r\n                sector.Image = Properties.Resources.sector1;\r\n\r\n                mainOverlay.Markers.Add(sector);\r\n\r\n                mainOverlay.Markers.Add(hidrat);\r\n\r\n            }\r\n        }\r\n\r\n        \r\n        <span style=\"color:blue\">void</span> mapControl_OnMapZoomChanged()\r\n        {\r\n            <span style=\"color:blue\">if</span> (hidrat != <span style=\"color:blue\">null</span>)\r\n            {\r\n                <span style=\"color:blue\">var</span> tl = mapControl1.FromLatLngToLocal(gtl);\r\n                <span style=\"color:blue\">var</span> br = mapControl1.FromLatLngToLocal(gbr);\r\n\r\n                hidrat.Position = gtl;\r\n                <span style=\"color:green\">//clouds.Size = new System.Drawing.Size(br.X - tl.X, br.Y - tl.Y);</span>\r\n                hidrat.Size = <span style=\"color:blue\">new</span> System.Drawing.Size(hidrat.Size.Width, hidrat.Size.Height);\r\n            }\r\n\r\n            <span style=\"color:blue\">if</span> (sector != <span style=\"color:blue\">null</span>)\r\n            {\r\n                <span style=\"color:blue\">var</span> tl = mapControl1.FromLatLngToLocal(pointSector1);\r\n                <span style=\"color:blue\">var</span> br = mapControl1.FromLatLngToLocal(pointSector2);\r\n\r\n                sector.Position = pointSector1;\r\n                sector.Size = <span style=\"color:blue\">new</span> System.Drawing.Size(br.X - tl.X, br.Y - tl.Y);\r\n            }\r\n\r\n        }\r\n\r\n\r\n        <span style=\"color:blue\">protected</span> <span style=\"color:blue\">override</span> <span style=\"color:blue\">void</span> OnLoad(EventArgs e)\r\n        {\r\n            <span style=\"color:blue\">base</span>.OnLoad(e);\r\n\r\n            mapControl1.SetZoomToFitRect(RectLatLng.FromLTRB(gtl.Lng, gtl.Lat, gbr.Lng, gbr.Lat));\r\n        }\r\n\r\n\r\n\r\n\r\n    }\r\n}\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2010-12-17T06:56:09.633-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "537414",
    "ThreadId": "238747",
    "Html": "\r\n<p>;/</p>\r\n",
    "PostedDate": "2010-12-17T10:19:38.257-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]